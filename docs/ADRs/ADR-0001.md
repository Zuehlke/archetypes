# ADR-0001: Move from Markdown-Embedded Data to Structured JSON Data

## Status
Proposed

## Context
Currently, all **Archetype**, **Skills/Topics**, and **Learning Resources** data is captured directly in markdown files. This approach has served the project well in its initial phase but creates limitations as the project grows.

### Current Approach
- Data is embedded directly in markdown files
- Simple build pipeline: `src/` → `MkDocs build` → `web static files`
- Manual maintenance of relationships between archetypes and topics
- No validation of data consistency
- Limited reusability of data outside the website

### Problems with Current Approach
1. **No validation**: No way to enforce data consistency or catch errors
2. **Limited tooling**: Difficult to build automated tools or integrations
3. **Data portability**: Cannot easily export data to other systems
4. **Maintenance overhead**: Risk of inconsistencies and broken links
5. **No formal domain model**: Contributors lack clear guidelines for data structure

## Decision
We will migrate from markdown-embedded data to structured YAML data files with the following approach:

### Target Architecture
1. **Add YAML frontmatter** to existing markdown files containing:
   - Archetype skill stage progressions
   - Topic learning resources and cross-references
   - Structured metadata for each content type

2. **Update build pipeline** to use MkDocs macro plugin:
   `Markdown with YAML frontmatter` → `MkDocs build with macro plugin` → `web static files`

3. **Implement gradual migration**:
   - Add frontmatter to existing files incrementally
   - Replace manual content sections with macro calls
   - YAML frontmatter can reference topics that don't exist yet (will result in 404s)
   - 404s guide content creation priorities
   - Existing URLs and site functionality maintained

### Data Format Choice: YAML Frontmatter
We chose YAML frontmatter (embedded in markdown files) over separate JSON/YAML data files for the following reasons:

**YAML Frontmatter Advantages:**
- **Simplest migration**: Add structured data to existing files without creating new ones
- **Single source**: Data and content stay together in one file
- **Standard pattern**: Common approach in static site generators (Jekyll, Hugo, etc.)
- **Human readability**: YAML is readable for manual editing and code reviews
- **Comments support**: Native comment support for documentation within data
- **Git-friendly**: Changes to data and content appear in same diff
- **No file coordination**: Cannot have data/content files get out of sync

**Validation:**
- Use JSON Schema for validation (fully compatible with YAML frontmatter)
- Frontmatter is extracted and validated like separate YAML files
- Build-time validation prevents deployment of invalid data

### Data Model
The structured data will be embedded as YAML frontmatter in existing markdown files:
- **Archetype files** → frontmatter with skill stages + content with macro calls
- **Topic files** → frontmatter with learning resources + content with macro calls
- Learning resources are embedded within topic frontmatter (not normalized) for simplicity and context preservation

### Key Design Decision: YAML Frontmatter Approach
Structured data will be stored as YAML frontmatter within existing markdown files rather than separate data files:

**Rationale:**
- **Simplest migration**: Add frontmatter to existing files vs. creating new file structure
- **Single source of truth**: Data and content in same file eliminates synchronization issues
- **Standard pattern**: Follows established static site generator conventions
- **Preserves context**: Same resource may have different descriptions per topic within same file
- **Enables independent editing**: Each file contains all information needed to understand and edit content

## Consequences

### Positive
1. **Clear domain model**: JSON schemas will document and enforce frontmatter data structure
2. **Better tooling**: Enables archetype visualizers, learning path builders, and trackers
3. **Data validation**: Automated checks for consistency and completeness using JSON Schema
4. **Data portability**: Frontmatter can be extracted and exported to other tools and systems
5. **Contributor guidance**: Clear YAML structure with comments helps contributors add content correctly
6. **Human-friendly**: YAML frontmatter is more approachable for manual editing and reviews
7. **Simplified maintenance**: All content in single files eliminates coordination complexity
8. **Minimal migration effort**: Add frontmatter to existing files rather than restructuring project

### Negative
1. **Increased complexity**: Build pipeline gains macro processing complexity
2. **Migration effort**: Requires adding frontmatter and macro calls to existing files
3. **Learning curve**: Contributors need to understand YAML frontmatter + macro syntax
4. **Tooling dependency**: Requires YAML parsing and JSON Schema validation in build process
5. **Mixed file format**: Files contain both YAML and Markdown (though this is standard practice)

### Neutral
1. **Gradual transition**: Can implement incrementally without breaking existing functionality
2. **Future flexibility**: Enables future enhancements like personalized learning paths

## Implementation Notes
- Use JSON Schema for validation of YAML frontmatter data
- Maintain existing URL structure for backward compatibility
- Implement comprehensive tests for frontmatter data consistency
- Document migration process for contributors (adding frontmatter + macro calls)
- Consider VS Code extensions for frontmatter editing and validation
- Enable comment usage in YAML frontmatter for inline documentation
- Extract frontmatter data for external tools when needed

## References
- [GitHub Issue #40](https://github.com/Zuehlke/archetypes/issues/40)
- [Data Architecture Documentation](./data-architecture.md)
- [Dreyfus Model of Skill Acquisition](https://en.wikipedia.org/wiki/Dreyfus_model_of_skill_acquisition)