# ADR-0001: Move from Markdown-Embedded Data to Structured JSON Data

## Status
Proposed

## Context
Currently, all **Archetype**, **Skills/Topics**, and **Learning Resources** data is captured directly in markdown files. This approach has served the project well in its initial phase but creates limitations as the project grows.

### Current Approach
- Data is embedded directly in markdown files
- Simple build pipeline: `src/` → `MkDocs build` → `web static files`
- Manual maintenance of relationships between archetypes and topics
- No validation of data consistency
- Limited reusability of data outside the website

### Problems with Current Approach
1. **No validation**: No way to enforce data consistency or catch errors
2. **Limited tooling**: Difficult to build automated tools or integrations
3. **Data portability**: Cannot easily export data to other systems
4. **Maintenance overhead**: Risk of inconsistencies and broken links
5. **No formal domain model**: Contributors lack clear guidelines for data structure

## Decision
We will migrate from markdown-embedded data to structured YAML data files with the following approach:

### Target Architecture
1. **Extract data** into standalone YAML files defining:
   - Archetypes with their skill stage progressions
   - Topics with learning resources and cross-references
   - Learning resources with standardized metadata

2. **Update build pipeline** to use MkDocs macro plugin:
   `YAML data files` → `MkDocs build with macro plugin` → `web static files`

3. **Implement gradual migration**:
   - YAML data can reference topics that don't exist yet (will result in 404s)
   - 404s guide content creation priorities
   - Existing URLs and site functionality maintained

### Data Format Choice: YAML
We chose YAML over JSON for the following reasons:

**YAML Advantages:**
- **Human readability**: More readable for manual editing and code reviews
- **Comments support**: Native comment support for documentation within data files
- **Multi-line strings**: Better handling of descriptions and embedded content
- **Git-friendly**: More readable diffs in pull requests
- **Contributor accessibility**: Easier for non-technical contributors to edit

**Validation:**
- Use JSON Schema for validation (fully compatible with YAML)
- YAML parsers convert to same data structures as JSON
- Existing JSON Schema tooling works seamlessly with YAML files

### Data Model
The structured data will follow a simplified entity model:
- **Archetype** → **Skill Stages** → **Topic References**
- **Topics** → **Embedded Learning Resources** + **Cross-references**
- Learning resources are embedded within topics (not normalized) for simplicity and context preservation

### Key Design Decision: Embedded Learning Resources
Learning resources will be stored directly within topic files rather than normalized into separate entities:

**Rationale:**
- Preserves contextual information (same resource may have different descriptions per topic)
- Simplifies editing and maintenance for contributors
- Avoids complex cross-referencing for content that is inherently topic-specific
- Enables independent editing of topics without affecting other content

## Consequences

### Positive
1. **Clear domain model**: JSON schemas will document and enforce data structure
2. **Better tooling**: Enables archetype visualizers, learning path builders, and trackers
3. **Data validation**: Automated checks for consistency and completeness using JSON Schema
4. **Portability**: Data can be exported to other tools and systems
5. **Contributor guidance**: Clear YAML structure with comments helps contributors add content correctly
6. **Human-friendly**: YAML format is more approachable for manual editing and reviews
7. **Simplified maintenance**: Embedded learning resources avoid complex normalization and cross-referencing

### Negative
1. **Increased complexity**: Build pipeline becomes more complex
2. **Migration effort**: Requires extracting and restructuring existing data
3. **Learning curve**: Contributors need to understand YAML structure vs. simple markdown
4. **Tooling dependency**: Requires YAML parsing and JSON Schema validation in build process

### Neutral
1. **Gradual transition**: Can implement incrementally without breaking existing functionality
2. **Future flexibility**: Enables future enhancements like personalized learning paths

## Implementation Notes
- Use JSON Schema for validation of YAML data files
- Maintain existing URL structure for backward compatibility
- Implement comprehensive tests for data consistency
- Document migration process for contributors
- Consider tooling for editing YAML data (vs. raw file editing)
- Enable comment usage in YAML files for inline documentation

## References
- [GitHub Issue #40](https://github.com/Zuehlke/archetypes/issues/40)
- [Data Architecture Documentation](./data-architecture.md)
- [Dreyfus Model of Skill Acquisition](https://en.wikipedia.org/wiki/Dreyfus_model_of_skill_acquisition)